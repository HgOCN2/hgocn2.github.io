import{_ as o,r as a,o as c,c as u,b as n,e as p,w as l,d as s,a as i}from"./app-VitiyI7N.js";const k={},r=n("h1",{id:"neural-network",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#neural-network","aria-hidden":"true"},"#"),s(" Neural Network")],-1),d=n("h1",{id:"embedding-lookup",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#embedding-lookup","aria-hidden":"true"},"#"),s(" embedding_lookup")],-1),m=n("p",null,"tf.nn.embedding_lookup函数的用法主要是选取一个张量里面索引对应的元素。tf.nn.embedding_lookup（params, ids）:params可以是张量也可以是数组等，id就是对应的索引，其他的参数不介绍。",-1),b={href:"https://www.cnblogs.com/gaofighting/p/9625868.html",target:"_blank",rel:"noopener noreferrer"},v=i(`<p><strong>ids只有一行：</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>p<span class="token operator">=</span>tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#生成5*1的张量</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>embedding_lookup<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#查找张量中的序号为1和3的</span>
 
<span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#print(c)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果是</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[[0.15791859]
 [0.6468804 ]]
[[-0.2737084 ]
 [ 0.15791859]
 [-0.01315552]
 [ 0.6468804 ]
 [-1.0601649 ]]
&lt;tf.Variable &#39;Variable:0&#39; shape=(10, 1) dtype=float32_ref&gt;
&lt;class &#39;tensorflow.python.ops.variables.Variable&#39;&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>如果ids是多行：</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2.1</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">,</span> <span class="token number">2.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3.1</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4.1</span><span class="token punctuation">,</span> <span class="token number">4.2</span><span class="token punctuation">,</span> <span class="token number">4.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
a <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
idx1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>
idx2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>
out1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>embedding_lookup<span class="token punctuation">(</span>a<span class="token punctuation">,</span> idx1<span class="token punctuation">)</span>
out2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>embedding_lookup<span class="token punctuation">(</span>a<span class="token punctuation">,</span> idx2<span class="token punctuation">)</span>
init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
    <span class="token keyword">print</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>out1<span class="token punctuation">)</span>
    <span class="token keyword">print</span> out1
    <span class="token keyword">print</span> <span class="token string">&#39;==================&#39;</span>
    <span class="token keyword">print</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>out2<span class="token punctuation">)</span>
    <span class="token keyword">print</span> out2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果是</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.1</span>  <span class="token number">0.2</span>  <span class="token number">0.3</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">2.1</span>  <span class="token number">2.2</span>  <span class="token number">2.3</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">3.1</span>  <span class="token number">3.2</span>  <span class="token number">3.3</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span> <span class="token number">1.1</span>  <span class="token number">1.2</span>  <span class="token number">1.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Tensor<span class="token punctuation">(</span><span class="token string">&quot;embedding_lookup:0&quot;</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>float64<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.1</span>  <span class="token number">0.2</span>  <span class="token number">0.3</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span> <span class="token number">2.1</span>  <span class="token number">2.2</span>  <span class="token number">2.3</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span> <span class="token number">3.1</span>  <span class="token number">3.2</span>  <span class="token number">3.3</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span> <span class="token number">1.1</span>  <span class="token number">1.2</span>  <span class="token number">1.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">4.1</span>  <span class="token number">4.2</span>  <span class="token number">4.3</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span> <span class="token number">0.1</span>  <span class="token number">0.2</span>  <span class="token number">0.3</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span> <span class="token number">2.1</span>  <span class="token number">2.2</span>  <span class="token number">2.3</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span> <span class="token number">2.1</span>  <span class="token number">2.2</span>  <span class="token number">2.3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
Tensor<span class="token punctuation">(</span><span class="token string">&quot;embedding_lookup_1:0&quot;</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>float64<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>如果张量是二维</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>p <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>random_normal<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#生成5*2的张量</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>embedding_lookup<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 查找张量中的序号为1和3的</span>

<span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># print(c)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果是</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[[-0.5707266   1.31594   ]
 [-0.16886874  0.11318349]]
[[-1.0407234  -1.1149817 ]
 [-0.5707266   1.31594   ]
 [ 0.41421786 -0.28062782]
 [-0.16886874  0.11318349]
 [ 0.7819106  -1.7940577 ]]
&lt;tf.Variable &#39;Variable:0&#39; shape=(5, 2) dtype=float32_ref&gt;
&lt;class &#39;tensorflow.python.ops.variables.RefVariable&#39;&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12);function g(f,h){const t=a("RouterLink"),e=a("ExternalLinkIcon");return c(),u("div",null,[r,n("ul",null,[n("li",null,[p(t,{to:"/docs/machine-learning/machine-learning-framework/tensorflow/tensorflow1.0/tensorflow1.0.html"},{default:l(()=>[s("返回上层目录")]),_:1})])]),d,m,n("p",null,[n("a",b,[s("tf.nn.embedding_lookup函数的用法"),p(e)])]),v])}const y=o(k,[["render",g],["__file","neural-network.html.vue"]]);export{y as default};
