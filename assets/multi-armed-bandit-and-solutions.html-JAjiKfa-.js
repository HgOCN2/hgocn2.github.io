import{_ as m,r as n,o as r,c as p,b as a,e as t,w as h,d as s,a as e}from"./app-VitiyI7N.js";const c="/assets/multi-armed-bandit-0SQD986j.jpg",o={},d=a("h1",{id:"多臂赌博机及其解法",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#多臂赌博机及其解法","aria-hidden":"true"},"#"),s(" 多臂赌博机及其解法")],-1),u=a("li",null,[a("a",{href:"#%E6%8E%A2%E7%B4%A2-%E5%88%A9%E7%94%A8%E5%9B%B0%E5%A2%83"},"探索-利用困境")],-1),g=a("li",null,[a("a",{href:"#%E5%A4%9A%E8%87%82%E8%B5%8C%E5%8D%9A%E6%9C%BA"},"多臂赌博机")],-1),x=e('<h1 id="探索-利用困境" tabindex="-1"><a class="header-anchor" href="#探索-利用困境" aria-hidden="true">#</a> 探索-利用困境</h1><p>所谓探索（Exploration）：是指做你以前从来没有做过的事情，以便获得更高的回报。</p><p>所谓利用（Exploitation）：是指做你当前知道的能产生最大回报的事情。</p><p>对于探索和利用的理解我们举个例子：假设你家附近有十个餐馆，到目前为止，你在八家餐馆吃过饭，知道这八家餐馆中哪家的餐馆饭最好吃。有一天，你女朋友来看你，你决定带她去餐馆吃饭。请问你带她去哪家餐馆？</p><p>当然，你最想带她去你家附近十个餐馆中最好吃的那家吃饭。但是，你只吃过八家，只知道吃过的八家中最好吃的是哪家。</p><p>在这个例子中，利用（exploitation）是指你带她去你知道的八家中最好吃的那家餐馆吃饭；而探索（exploration）是你带她去你从没吃过的第九家或第十家吃饭。</p><p>问题是你该带她去八家中最好吃的那家还是去没吃过的那两家。如果你带她去八家中最好吃的那家，那么也许第九家或第十家比你吃过的八家都要好一万倍。但是，如果你带她去第九家或第十家，也许这两家比你吃过的八家最差的都要差上一万倍。</p><p>那么，你到底该去哪家呢？</p><p>这就是探索-利用困境。</p><p>一个标准的强化学习算法必然要包括探索和利用。探索帮助智能体充分了解它的状态空间，利用则帮助智能体找到最优的动作序列。</p><h1 id="多臂赌博机" tabindex="-1"><a class="header-anchor" href="#多臂赌博机" aria-hidden="true">#</a> 多臂赌博机</h1><p>探索与利用平衡问题中最经典的一个问题就是多臂赌博机问题（Multi-Armed Bandit），最早的探索-利用困境是学者们在研究多臂赌博机（Multi-Armed Bandit）时遇到的。</p><p><img src="'+c+'" alt="multi-armed-bandit"></p><p>上图为多臂赌博机的示意图。多臂赌博机由一个盛着金币的箱子、K个臂（图中为3个臂）组成。玩家通过按压摇臂来获得金币（回报）。</p><p><strong>多臂赌博机的问题是：你按压哪个臂能得到最大的回报？</strong></p><p>问题假设：按下摇臂后的回报取值为1或0，每个摇臂获得回报的概率服从不同的分布，但事先并不知道</p><p>问题目标：按照某种策略来按压摇臂以获得最大的累计回报（咦，这不就是强化学习的目标嘛）</p><p>在这个问题中，探索与利用就是：</p><p>利用（exploitation）：按压之前获得回报概率最高的那个臂，以获得更高的累计回报。但是因为回报是随机的，对每个臂的回报概率的估计并不准确，或许真实回报概率最高的那个臂并非当前估计的那个臂。</p><p>探索（exploration）：随机地去按压不同的臂，得到每个臂更精确的回报概率估计，从而找到真实的那个最优的臂。但是要探索，就要去按压目前回报概率估计并不高的臂，意味着会损失一些按压高回报摇臂的机会。</p><p>窘境：因为尝试次数有限，所以探索和利用是矛盾的，加强一方必然削弱另一方。要想回报最大，则必须在探索和利用之中达成较好的平衡。</p><p>那如何来平衡探索和利用呢？</p><p>用数学语言定义如下：</p>',23),w=a("p",null,[s("一个伯努利多臂赌博机可描述为"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"<"),a("mi",{mathvariant:"script"},"A"),a("mo",{separator:"true"},","),a("mi",{mathvariant:"script"},"R"),a("mo",null,">")]),a("annotation",{encoding:"application/x-tex"},"<\\mathcal{A}, \\mathcal{R}>")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.5782em","vertical-align":"-0.0391em"}}),a("span",{class:"mrel"},"<"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.8778em","vertical-align":"-0.1944em"}}),a("span",{class:"mord mathcal"},"A"),a("span",{class:"mpunct"},","),a("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),a("span",{class:"mord mathcal"},"R"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},">")])])]),s("，其中")],-1),b=a("ul",null,[a("li",null,[s("多臂赌博机有"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"K")]),a("annotation",{encoding:"application/x-tex"},"K")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K")])])]),s("个臂，其获奖概率分别为"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",{stretchy:"false"},"{"),a("msub",null,[a("mi",null,"θ"),a("mn",null,"1")]),a("mo",{separator:"true"},","),a("mi",{mathvariant:"normal"},"."),a("mi",{mathvariant:"normal"},"."),a("mi",{mathvariant:"normal"},"."),a("mo",{separator:"true"},","),a("msub",null,[a("mi",null,"θ"),a("mi",null,"K")]),a("mo",{stretchy:"false"},"}")]),a("annotation",{encoding:"application/x-tex"},"\\{\\theta_1, ..., \\theta_K\\}")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mopen"},"{"),a("span",{class:"mord"},[a("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"θ"),a("span",{class:"msupsub"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.3011em"}},[a("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[a("span",{class:"pstrut",style:{height:"2.7em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mtight"},"1")])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.15em"}},[a("span")])])])])]),a("span",{class:"mpunct"},","),a("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),a("span",{class:"mord"},"..."),a("span",{class:"mpunct"},","),a("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),a("span",{class:"mord"},[a("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"θ"),a("span",{class:"msupsub"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.3283em"}},[a("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[a("span",{class:"pstrut",style:{height:"2.7em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"K")])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.15em"}},[a("span")])])])])]),a("span",{class:"mclose"},"}")])])])]),a("li",null,[s("每次时间步"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"t")]),a("annotation",{encoding:"application/x-tex"},"t")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6151em"}}),a("span",{class:"mord mathnormal"},"t")])])]),s("只操作其中一个赌博机，该操作记为"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a")]),a("annotation",{encoding:"application/x-tex"},"a")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a")])])]),s("，并得到奖励"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"r")]),a("annotation",{encoding:"application/x-tex"},"r")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r")])])])]),a("li",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"script"},"A")]),a("annotation",{encoding:"application/x-tex"},"\\mathcal{A}")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathcal"},"A")])])]),s("是一组动作的集合，里面每个动作分别代表了对一个机器的操作。动作"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a")]),a("annotation",{encoding:"application/x-tex"},"a")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a")])])]),s("的值就是期望奖励"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"Q"),a("mo",{stretchy:"false"},"("),a("mi",null,"a"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("mi",{mathvariant:"double-struck"},"E"),a("mo",{stretchy:"false"},"["),a("mi",null,"r"),a("mi",{mathvariant:"normal"},"∣"),a("mi",null,"a"),a("mo",{stretchy:"false"},"]"),a("mo",null,"="),a("mi",null,"θ")]),a("annotation",{encoding:"application/x-tex"},"Q(a)=\\mathbb{E}[r|a]=\\theta")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord mathnormal"},"Q"),a("span",{class:"mopen"},"("),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mclose"},")"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord mathbb"},"E"),a("span",{class:"mopen"},"["),a("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),a("span",{class:"mord"},"∣"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mclose"},"]"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6944em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"θ")])])]),s("。若时间步"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"t")]),a("annotation",{encoding:"application/x-tex"},"t")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6151em"}}),a("span",{class:"mord mathnormal"},"t")])])]),s("的动作"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("msub",null,[a("mi",null,"a"),a("mi",null,"t")])]),a("annotation",{encoding:"application/x-tex"},"a_t")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),a("span",{class:"mord"},[a("span",{class:"mord mathnormal"},"a"),a("span",{class:"msupsub"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.2806em"}},[a("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{class:"pstrut",style:{height:"2.7em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mathnormal mtight"},"t")])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.15em"}},[a("span")])])])])])])])]),s("是操作第"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"i")]),a("annotation",{encoding:"application/x-tex"},"i")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6595em"}}),a("span",{class:"mord mathnormal"},"i")])])]),s("个赌博机，则"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"A"),a("mo",{stretchy:"false"},"("),a("msub",null,[a("mi",null,"a"),a("mi",null,"t")]),a("mo",{stretchy:"false"},")")]),a("annotation",{encoding:"application/x-tex"},"A(a_t)")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord mathnormal"},"A"),a("span",{class:"mopen"},"("),a("span",{class:"mord"},[a("span",{class:"mord mathnormal"},"a"),a("span",{class:"msupsub"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.2806em"}},[a("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{class:"pstrut",style:{height:"2.7em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mathnormal mtight"},"t")])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.15em"}},[a("span")])])])])]),a("span",{class:"mclose"},")")])])])])],-1),y=e('<h1 id="ε-贪婪算法" tabindex="-1"><a class="header-anchor" href="#ε-贪婪算法" aria-hidden="true">#</a> ε-贪婪算法</h1><h1 id="上置信界算法" tabindex="-1"><a class="header-anchor" href="#上置信界算法" aria-hidden="true">#</a> 上置信界算法</h1><h2 id="hoeffding不等式" tabindex="-1"><a class="header-anchor" href="#hoeffding不等式" aria-hidden="true">#</a> Hoeffding不等式</h2><p>Hoeffding&#39;s Inequality</p><h2 id="ucb1" tabindex="-1"><a class="header-anchor" href="#ucb1" aria-hidden="true">#</a> UCB1</h2><h2 id="贝叶斯ucb" tabindex="-1"><a class="header-anchor" href="#贝叶斯ucb" aria-hidden="true">#</a> 贝叶斯UCB</h2><h1 id="thompson采样" tabindex="-1"><a class="header-anchor" href="#thompson采样" aria-hidden="true">#</a> Thompson采样</h1><p>Thompson Sampling</p><h1 id="参考文献" tabindex="-1"><a class="header-anchor" href="#参考文献" aria-hidden="true">#</a> 参考文献</h1>',9),_={href:"https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html",target:"_blank",rel:"noopener noreferrer"},f=a("p",null,"本文参考并翻译了这篇文章。",-1),k={href:"https://blog.csdn.net/songyunli1111/article/details/83384738",target:"_blank",rel:"noopener noreferrer"},v=a("p",null,"本文参考了这篇博客。",-1),M=a("p",null,"===",-1),A={href:"https://www.baidu.com/link?url=MJVRzwRexK_ggwql5Sz48ulGR6Rac34oHqn09iGofbvIjQ_AaPs3WGmFp2dTW13Vt00WLRgmqsC5cEUnAuGJJkbab7-hUdHlB0t8XIW_R0K&wd=&eqid=adaffffc001c57c50000000360cdcde5",target:"_blank",rel:"noopener noreferrer"},E={href:"https://zhuanlan.zhihu.com/p/33146752",target:"_blank",rel:"noopener noreferrer"};function L(B,z){const i=n("RouterLink"),l=n("ExternalLinkIcon");return r(),p("div",null,[d,a("ul",null,[a("li",null,[t(i,{to:"/docs/machine-learning/reinforcement-learning/reinforcement-learning/reinforcement-learning.html"},{default:h(()=>[s("返回上层目录")]),_:1})]),u,g]),x,w,b,y,a("ul",null,[a("li",null,[a("a",_,[s("The Multi-Armed Bandit Problem and Its Solutions"),t(l)])])]),f,a("ul",null,[a("li",null,[a("a",k,[s("UCB公式的理解"),t(l)])])]),v,M,a("ul",null,[a("li",null,[a("a",A,[s("UCB公式的理解"),t(l)])]),a("li",null,[a("a",E,[s("高级强化学习系列 第二讲 探索-利用困境（exploration-exploitation dilemma）（二）"),t(l)])])])])}const C=m(o,[["render",L],["__file","multi-armed-bandit-and-solutions.html.vue"]]);export{C as default};
